<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threads Master Tool | Risu Lab</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Zen+Kaku+Gothic+New:wght@400;700&display=swap');

        :root {
            --bg-color: #F8FAFC;
            /* Slate 50 */
            --card-bg: #FFFFFF;
            --text-color: #0F172A;
            /* Slate 900 */
            --accent: #0284C7;
            /* Sky 600 */
            --accent-dim: rgba(2, 132, 199, 0.1);
            --danger: #EF4444;
            --success: #10B981;
            --glass: rgba(0, 0, 0, 0.05);
            --border: #E2E8F0;
            /* Slate 200 */
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Zen Kaku Gothic New', sans-serif;
            margin: 0;
            padding: 2rem;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 900px;
            position: relative;
        }

        h1 {
            font-family: 'Inter', sans-serif;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #0F172A 0%, #475569 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            font-size: 0.4em;
            background: var(--accent);
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            vertical-align: middle;
            font-weight: bold;
        }

        .subtitle {
            color: #64748B;
            margin-bottom: 2rem;
            font-size: 0.95rem;
        }

        /* --- API & Model Selection --- */
        .api-box {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .api-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .api-row input {
            flex: 2;
            background: #F1F5F9;
            border: 1px solid var(--border);
            color: var(--text-color);
            padding: 0.6rem;
            border-radius: 6px;
        }

        .btn-check {
            background: #E2E8F0;
            color: #1E293B;
            border: none;
            padding: 0.6rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            white-space: nowrap;
            font-weight: bold;
        }

        .btn-check:hover {
            background: #CBD5E1;
        }

        .help-link {
            color: var(--accent);
            text-decoration: underline;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 10px;
        }

        select#modelSelect {
            width: 100%;
            background: #F1F5F9;
            color: var(--text-color);
            border: 1px solid var(--border);
            padding: 0.6rem;
            border-radius: 6px;
        }

        /* --- Generator Section --- */
        .generator-box {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #475569;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            background: #F1F5F9;
            border: 1px solid var(--border);
            color: var(--text-color);
            padding: 0.8rem;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent);
            background: #fff;
        }

        .gen-btn {
            background: linear-gradient(135deg, var(--accent) 0%, #0369A1 100%);
            color: #fff;
            border: none;
            padding: 1rem;
            width: 100%;
            font-size: 1.1rem;
            font-weight: 800;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.1s;
            box-shadow: 0 4px 6px var(--accent-dim);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .gen-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #94A3B8;
        }

        /* --- Editor/Analyzer Section --- */
        .editor-box {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        textarea {
            width: 100%;
            height: 400px;
            background: #fff;
            border: 1px solid var(--border);
            color: var(--text-color);
            padding: 1.5rem;
            border-radius: 12px;
            font-size: 1.05rem;
            line-height: 1.8;
            resize: vertical;
            box-sizing: border-box;
            font-family: inherit;
        }

        .analysis-panel {
            background: #F8FAFC;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            height: fit-content;
        }

        .ai-feedback {
            font-size: 0.9rem;
            color: #334155;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, .3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        /* --- Modal --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #fff;
            padding: 2rem;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            border: 1px solid #CBD5E1;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #64748B;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .step-list {
            padding-left: 20px;
            color: #475569;
            line-height: 1.8;
        }

        .feedback-link {
            position: absolute;
            top: 1rem;
            right: 0;
            color: #64748B;
            font-size: 0.85rem;
            background: rgba(0, 0, 0, 0.05);
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            text-decoration: none;
            transition: all 0.2s;
        }

        .feedback-link:hover {
            color: #0F172A;
            background: rgba(0, 0, 0, 0.1);
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 768px) {
            .editor-box {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .feedback-link {
                position: static;
                display: block;
                top: 1rem;
                right: 0;
                color: #888;
                font-size: 0.85rem;
                background: rgba(255, 255, 255, 0.05);
                padding: 0.4rem 0.8rem;
                border-radius: 4px;
                text-decoration: none;
                transition: all 0.2s;
            }

            .feedback-link:hover {
                color: #fff;
                background: rgba(255, 255, 255, 0.1);
            }

            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }

            @media (max-width: 768px) {
                .editor-box {
                    grid-template-columns: 1fr;
                }

                .form-grid {
                    grid-template-columns: 1fr;
                }

                .feedback-link {
                    position: static;
                    display: block;
                    width: fit-content;
                    margin-bottom: 1rem;
                }
            }
    </style>
</head>

<body>

    <div class="container">
        <h1>Threads Master <span class="badge">BETA</span></h1>
        <a href="https://twitter.com/intent/tweet?text=Threads%20Master%20Tool%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%Bf%E3%81%BE%E3%81%97%E3%81%9F%EF%BC%81%0A%23ThreadsMaster"
            target="_blank" class="feedback-link">ğŸ“¢ æ„Ÿæƒ³ãƒ»è¦æœ›ã‚’é€ã‚‹</a>
        <p class="subtitle">ãƒ¢ãƒ‡ãƒ«è‡ªå‹•å–å¾—æ©Ÿèƒ½ Ã— è©³ç´°ãƒ‰ãƒ©ãƒ•ãƒˆç”Ÿæˆãƒ¢ãƒ¼ãƒ‰</p>

        <!-- API & Model Selection -->
        <div class="api-box">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;">
                <label style="font-weight:bold; font-size:0.9rem;">STEP 1: APIæ¥ç¶šè¨­å®š</label>
                <span class="help-link" onclick="openModal()">â“ APIã‚­ãƒ¼ã®å–å¾—æ–¹æ³•</span>
            </div>

            <div class="api-row">
                <input type="password" id="apiKey" placeholder="AI Studioã®ã‚­ãƒ¼ã‚’è²¼ã£ã¦ãã ã•ã„ (AIza...)">
                <button class="btn-check" onclick="fetchModels()">ğŸ“¡ ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—</button>
            </div>

            <select id="modelSelect" disabled>
                <option value="">(ğŸ‘† å…ˆã«ã€Œãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„)</option>
            </select>
        </div>

        <!-- Generator -->
        <div class="generator-box">
            <h3
                style="margin-top:0; margin-bottom:1.5rem; color:var(--text-color); border-bottom:1px solid var(--border); padding-bottom:1rem;">
                âš¡ï¸ Advanced Generator</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label>æŠ•ç¨¿ã‚¿ã‚¤ãƒ—</label>
                    <select id="genType">
                        <option value="å…±æ„Ÿå‹">â‘  å…±æ„Ÿå‹ (ãƒ•ã‚¡ãƒ³åŒ–ãƒ»å¼±ã¿é–‹ç¤º)</option>
                        <option value="æœ‰ç›Šå‹">â‘¡ æœ‰ç›Šå‹ (ä¿¡é ¼æ§‹ç¯‰ãƒ»ãƒã‚¦ãƒã‚¦)</option>
                        <option value="ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆå‹">â‘¢ ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆå‹ (åç›ŠåŒ–)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±æ€§</label>
                    <input type="text" id="genTarget" placeholder="ä¾‹ï¼š45æ­³ãƒ»å°†æ¥ä¸å®‰ãƒ»AIåˆå¿ƒè€…">
                </div>
                <div class="form-group">
                    <label>ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</label>
                    <input type="text" id="genKeyword" placeholder="ä¾‹ï¼šAIå‰¯æ¥­">
                </div>
                <div class="form-group">
                    <label>è£ãƒ†ãƒ¼ãƒï¼ˆçœç•¥å¯ï¼‰</label>
                    <input type="text" id="genSubKeyword" placeholder="ä¾‹ï¼šå®Ÿã¯ç°¡å˜ã€30åˆ†ã§OK">
                </div>
            </div>
            <button class="gen-btn" onclick="generateWithAI()" id="genBtn" disabled>âœ¨ AIã§æŠ•ç¨¿ã‚’ç”Ÿæˆãƒ»åˆ†æã™ã‚‹</button>
        </div>

        <!-- Editor & Analyzer -->
        <div class="editor-box">
            <div>
                <textarea id="postContent" placeholder="ã“ã“ã«ç”Ÿæˆã•ã‚ŒãŸãƒ‰ãƒ©ãƒ•ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚"></textarea>
            </div>

            <div class="analysis-panel">
                <h3 style="margin-top:0; color:var(--accent);">ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆãƒ»è£œè¶³</h3>
                <div id="aiFeedback" class="ai-feedback">
                    ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€æŠ•ç¨¿ã®æ„å›³ã‚„è£œè¶³äº‹é …ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
                </div>
            </div>
        </div>

        <!-- Usage & Disclaimer -->
        <div
            style="margin-top: 3rem; border-top: 1px solid var(--border); padding-top: 2rem; color: #64748B; font-size: 0.85rem; line-height: 1.6;">
            <h4 style="color: var(--text-color); margin-bottom: 0.5rem;">ğŸ“Œ åˆ©ç”¨è¦ç´„ãƒ»å…è²¬äº‹é …</h4>
            <ul style="padding-left: 20px;">
                <li>æœ¬ãƒ„ãƒ¼ãƒ«ã¯ã€ThreadsæŠ•ç¨¿ã®ä½œæˆã‚’æ”¯æ´ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</li>
                <li>å…¥åŠ›ã•ã‚ŒãŸAPIã‚­ãƒ¼ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã«ã®ã¿ä¸€æ™‚ä¿å­˜ã•ã‚Œã€å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã«ã¯é€ä¿¡ã•ã‚Œã¾ã›ã‚“ãŒã€ç®¡ç†ã¯è‡ªå·±è²¬ä»»ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚</li>
                <li>Google Gemini APIã®ä»•æ§˜å¤‰æ›´ã‚„éšœå®³ã«ã‚ˆã‚Šã€äºˆå‘Šãªãåˆ©ç”¨ã§ããªããªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</li>
                <li>ç”Ÿæˆã•ã‚ŒãŸæ–‡ç« ã¯ã€å¿…ãšã”è‡ªèº«ã§å†…å®¹ã‚’ç¢ºèªãƒ»ä¿®æ­£ã—ã¦ã‹ã‚‰æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚</li>
            </ul>
            <p style="margin-top: 1rem;">Â© 2026 Risu Lab. All rights reserved.</p>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal(event)">Ã—</button>
            <h3 style="margin-top:0; color:var(--accent)">ğŸ”‘ ç„¡æ–™APIã‚­ãƒ¼ã®å–å¾—æ‰‹é †</h3>
            <ol class="step-list">
                <li><a href="https://aistudio.google.com/app/apikey" target="_blank" style="color:var(--accent)">Google
                        AI Studio</a> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚</li>
                <li>ã€ŒCreate API keyã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</li>
                <li>ã€ŒCreate API key in new projectã€ã‚’é¸æŠã—ã¾ã™ã€‚</li>
                <li>è¡¨ç¤ºã•ã‚ŒãŸæ–‡å­—åˆ—ï¼ˆAIza...ï¼‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚</li>
                <li>ã“ã®ãƒ„ãƒ¼ãƒ«ã®å…¥åŠ›æ¬„ã«è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚</li>
            </ol>
            <p style="font-size:0.9rem; color:#888;">â€» å€‹äººåˆ©ç”¨ã®ç¯„å›²ï¼ˆ1åˆ†é–“ã«15å›ä»¥ä¸‹ï¼‰ã§ã‚ã‚Œã°ã€æ–™é‡‘ã¯ç™ºç”Ÿã—ã¾ã›ã‚“ï¼ˆå®Œå…¨ç„¡æ–™ï¼‰ã€‚</p>
        </div>
    </div>

    <script>
        // --- Modal Logic ---
        function openModal() {
            document.getElementById('helpModal').style.display = 'flex';
        }

        function closeModal(e) {
            if (e.target === document.getElementById('helpModal') || e.target.classList.contains('close-btn')) {
                document.getElementById('helpModal').style.display = 'none';
            }
        }

        // ----------------------------------------------------
        // Function 1: Fetch Models
        // ----------------------------------------------------
        async function fetchModels() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const select = document.getElementById('modelSelect');
            const genBtn = document.getElementById('genBtn');

            if (!apiKey) {
                alert("APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
                return;
            }

            select.innerHTML = '<option>ãƒ­ãƒ¼ãƒ‰ä¸­...</option>';
            select.disabled = true;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`);

                if (!response.ok) {
                    const errText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errText}`);
                }

                const data = await response.json();

                // Filter only 'generateContent' supported models
                const usableModels = data.models.filter(m =>
                    m.supportedGenerationMethods && m.supportedGenerationMethods.includes("generateContent")
                );

                select.innerHTML = '';

                // Prioritize recent models
                usableModels.sort((a, b) => {
                    return b.name.localeCompare(a.name);
                });

                usableModels.forEach(m => {
                    if (m.name.includes('gemini')) {
                        const option = document.createElement('option');
                        option.value = m.name.replace('models/', '');
                        option.text = `${m.displayName} (${m.name.replace('models/', '')})`;
                        select.appendChild(option);
                    }
                });

                if (select.options.length === 0) {
                    const option = document.createElement('option');
                    option.text = "ä½¿ãˆã‚‹Geminiãƒ¢ãƒ‡ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ";
                    select.appendChild(option);
                } else {
                    select.disabled = false;
                    genBtn.disabled = false;
                    // Auto-select flash or pro if available
                    for (let i = 0; i < select.options.length; i++) {
                        if (select.options[i].value.includes('flash')) {
                            select.selectedIndex = i;
                            break;
                        }
                    }
                    // Save API Key to Local Storage (Optional convenience)
                    localStorage.setItem('gemini_api_key', apiKey);
                }

            } catch (e) {
                console.error(e);
                select.innerHTML = '<option>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</option>';
                alert("æ¥ç¶šã‚¨ãƒ©ãƒ¼ï¼APIã‚­ãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\nè©³ç´°: " + e.message);
            }
        }

        // Auto-load API Key if saved
        window.onload = function () {
            const savedKey = localStorage.getItem('gemini_api_key');
            if (savedKey) {
                document.getElementById('apiKey').value = savedKey;
            }
        }

        // ----------------------------------------------------
        // Function 2: Generate Content
        // ----------------------------------------------------
        async function generateWithAI() {
            const apiKey = document.getElementById('apiKey').value;
            const modelName = document.getElementById('modelSelect').value;

            if (!apiKey || !modelName) {
                alert("APIã‚­ãƒ¼ã¨ãƒ¢ãƒ‡ãƒ«ã®è¨­å®šãŒå¿…è¦ã§ã™ã€‚");
                return;
            }

            const type = document.getElementById('genType').value;
            const target = document.getElementById('genTarget').value;
            const keyword = document.getElementById('genKeyword').value;
            const subKeyword = document.getElementById('genSubKeyword').value;

            const btn = document.getElementById('genBtn');
            const feedbackDiv = document.getElementById('aiFeedback');
            const textarea = document.getElementById('postContent');

            // UI Loading State
            btn.disabled = true;
            btn.innerHTML = '<div class="loading"></div> ç”Ÿæˆä¸­...';
            feedbackDiv.innerText = "AIãŒæ€è€ƒä¸­... (" + modelName + ")";

            // System Prompt with User Style
            const systemPrompt = `
ã‚ãªãŸã¯ãƒ—ãƒ­ã®SNSãƒãƒ¼ã‚±ã‚¿ãƒ¼ã§ã‚ã‚Šã€ä»¥ä¸‹ã®ã€ŒåŸ·ç­†ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆRisu Styleï¼‰ã€ã‚’å®Œç’§ã«æ¨¡å€£ã™ã‚‹ã‚´ãƒ¼ã‚¹ãƒˆãƒ©ã‚¤ã‚¿ãƒ¼ã§ã™ã€‚

ã€é‡è¦ãªå¤‰æ›´ç‚¹ã€‘
**ã€Œå¾Œã§ä¿®æ­£ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ã™ã‚‹ã€ã®ã§ã¯ãªãã€æœ€åˆã‹ã‚‰ãã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’åæ˜ ã—ãŸã€Œå®Œæˆåº¦ã®é«˜ã„æŠ•ç¨¿ã€ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚**
èª­ã¿æ‰‹ãŒåå¿œã›ã–ã‚‹ã‚’å¾—ãªã„å¿ƒç†ãƒˆãƒªã‚¬ãƒ¼ã€ãƒªã‚ºãƒ ã€æ”¹è¡Œã®ä½ç½®ã¾ã§ã€ã™ã¹ã¦è¨ˆç®—ã—å°½ãã—ãŸçŠ¶æ…‹ã§å‡ºåŠ›ã™ã‚‹ã“ã¨ã€‚

ã€åŸ·ç­†ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆRisu Styleï¼‰ã€‘
1. **ãƒˆãƒ¼ãƒ³**: ç­‰èº«å¤§ã®å­¦ç¿’è€…ã€‚ã€Œã€œã§ã™ã­ã€ã€Œã€œã¾ã™ã€ã‚’åŸºæœ¬ã«ã€æ–­å®šã‚’é¿ã‘ãŸæŸ”ã‚‰ã‹ã„å£èª¿ã€‚
2. **NG**: çµµæ–‡å­—ã¯ä¸€åˆ‡ä½¿ã‚ãªã„ã€‚ã€Œï¼ˆæ±—ï¼‰ã€ã€Œï¼ˆç¬‘ï¼‰ã€ã€Œï¼ˆèªå½™åŠ›æ¬ å¦‚ï¼‰ã€ã®ã‚ˆã†ãªã‚«ãƒƒã‚³æ›¸ãã®è‡ªåˆ†èªã‚Šã‚„æ„Ÿæƒ…è¡¨ç¾ã‚‚ç¦æ­¢ã€‚è¨˜å·ï¼ˆï¼ã€ï¼Ÿã€â€¦ï¼‰ã¯è‡ªç„¶ãªç¯„å›²ã§ä½¿ã†ã€‚
3. **å§¿å‹¢**: å‰ãã†ã«ã›ãšã€ã‚ãã¾ã§ã€Œè‡ªåˆ†ã‚‚å®Ÿè·µä¸­ã€ã¨ã„ã†ã‚¹ã‚¿ãƒ³ã‚¹ã§ã€‚
4. **ãƒªã‚ºãƒ **: 1æ–‡ã”ã¨ã«ã“ã¾ã‚ã«æ”¹è¡Œã™ã‚‹ã€‚ä½™ç™½ã‚’å¤§åˆ‡ã«ã™ã‚‹ã€‚
5. **å†…å®¹**: å˜ãªã‚‹æ„Ÿæƒ³ã§ã¯ãªãã€ã€Œè‡ªåˆ†ãªã‚Šã®æ°—ã¥ãï¼ˆã‚¤ãƒ³ã‚µã‚¤ãƒˆï¼‰ã€ã‚’å¿…ãšå…¥ã‚Œã‚‹ã€‚

ã€æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘
1. å…±æ„Ÿå‹: æ‚©ã¿ã‚„å¼±ã¿ã‚’ã•ã‚‰ã‘å‡ºã—ã€ã€ŒåŒå¿—ã€ã¨ã—ã¦ã®å…±æ„Ÿã‚’å¾—ã‚‹ã€‚
2. æœ‰ç›Šå‹: ãƒã‚¦ãƒã‚¦ã ã‘ã§ãªãã€ã€Œãªãœãã‚ŒãŒé‡è¦ã‹ã€ã®èƒŒæ™¯ã‚’èªã‚‹ã€‚
3. ã‚¢ãƒ•ã‚£å‹: å¼·ãå£²ã‚‹ã®ã§ã¯ãªãã€ã€Œè‡ªåˆ†ãŒä½¿ã£ã¦ã©ã†å¤‰ã‚ã£ãŸã‹ã€ã‚’é™ã‹ã«èªã‚‹ã€‚

ã€å‘½ä»¤ã€‘
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›æ¡ä»¶ã‚’ã‚‚ã¨ã«ã€ä»¥ä¸‹ã®2ã¤ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

1. **ThreadsæŠ•ç¨¿ã®å®ŒæˆåŸç¨¿**ï¼ˆRisu Styleå³å®ˆãƒ»ä¿®æ­£ä¸è¦ãªãƒ¬ãƒ™ãƒ«ã§ï¼‰
2. **æŠ•ç¨¿ã®ãƒã‚¤ãƒ³ãƒˆãƒ»è£œè¶³**ï¼ˆãªãœã“ã®è¡¨ç¾ã«ã—ãŸã‹ã®æ„å›³ã‚„ã€æŠ•ç¨¿æ™‚ã«æ°—ã‚’ã¤ã‘ã‚‹ã¹ãã€Œã‚ãˆã¦æ®‹ã—ãŸä½™ç™½ã€ãªã©ãŒã‚ã‚Œã°ï¼‰

å‡ºåŠ›ã¯JSONå½¢å¼ã§ã¯ãªãã€è¦‹ã‚„ã™ã„ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚
å‰åŠã«ã€Œ---DRAFT START---ã€ã¨ã€Œ---DRAFT END---ã€ã§å›²ã£ãŸæŠ•ç¨¿æ¡ˆã‚’å‡ºã—ã€ãã®å¾Œã«çŸ­ã„è£œè¶³ã‚’ç¶šã‘ã¦ãã ã•ã„ã€‚
`;

            const userPrompt = `
ã‚¿ã‚¤ãƒ—: ${type}
ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ: ${target}
ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ${keyword}
ã‚µãƒ–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ${subKeyword}

ã“ã®æ¡ä»¶ã§ã€ä¿®æ­£ä¸è¦ãªãƒ¬ãƒ™ãƒ«ã®æœ€é«˜å“è³ªãªThreadsæŠ•ç¨¿ã‚’ä½œã£ã¦ãã ã•ã„ã€‚
`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: systemPrompt + "\n" + userPrompt }]
                        }]
                    })
                });

                if (!response.ok) {
                    const errText = await response.text();
                    throw new Error(`Error ${response.status}: ${errText}`);
                }

                const data = await response.json();
                const rawText = data.candidates[0].content.parts[0].text;

                // Parse Output
                const draftMatch = rawText.match(/---DRAFT START---([\s\S]*?)---DRAFT END---/);
                const draft = draftMatch ? draftMatch[1].trim() : rawText;
                const feedback = rawText.replace(/---DRAFT START---[\s\S]*?---DRAFT END---/, "").trim();

                textarea.value = draft;
                feedbackDiv.innerText = feedback;

            } catch (e) {
                alert("ç”Ÿæˆã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚\nè©³ç´°: " + e.message);
                feedbackDiv.innerText = "âš ï¸ ã‚¨ãƒ©ãƒ¼è©³ç´°:\n" + e.message;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'âœ¨ AIã§æŠ•ç¨¿ã‚’ç”Ÿæˆãƒ»åˆ†æã™ã‚‹';
            }
        }
    </script>

</body>

</html>